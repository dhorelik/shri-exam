/*
* @TouchSwipe
* @version 1.6.3
* @author Matt Bryson http://www.github.com/mattbryson
*/
(function(e){"use strict";function N(t){if(t&&t.allowPageScroll===undefined&&(t.swipe!==undefined||t.swipeStatus!==undefined)){t.allowPageScroll=u}if(t.click!==undefined&&t.tap===undefined){t.tap=t.click}if(!t){t={}}t=e.extend({},e.fn.swipe.defaults,t);return this.each(function(){var n=e(this);var r=n.data(x);if(!r){r=new C(this,t);n.data(x,r)}})}function C(T,N){function Z(t){if(Dt())return;if(e(t.target).closest(N.excludedElements,R).length>0)return;var n=t.originalEvent?t.originalEvent:t;var r,i=S?n.touches[0]:n;U=y;if(S){z=n.touches.length}else{t.preventDefault()}_=0;D=null;I=null;P=0;H=0;B=0;j=1;F=0;W=Ft();q=Rt();Mt();if(!S||z===N.fingers||N.fingers===m||pt()){Ht(0,i);X=Qt();if(z==2){Ht(1,n.touches[1]);H=B=Wt(W[0].start,W[1].start)}if(N.swipeStatus||N.pinchStatus){r=ot(n,U)}}else{r=false}if(r===false){U=E;ot(n,U);return r}else{Pt(true)}}function et(e){var t=e.originalEvent?e.originalEvent:e;if(U===w||U===E||_t())return;var n,r=S?t.touches[0]:t;var i=Bt(r);V=Qt();if(S){z=t.touches.length}U=b;if(z==2){if(H==0){Ht(1,t.touches[1]);H=B=Wt(W[0].start,W[1].start)}else{Bt(t.touches[1]);B=Wt(W[0].end,W[1].end);I=Vt(W[0].end,W[1].end)}j=Xt(H,B);F=Math.abs(H-B)}if(z===N.fingers||N.fingers===m||!S||pt()){D=Kt(i.start,i.end);ct(e,D);_=$t(i.start,i.end);P=zt();It(D,_);if(N.swipeStatus||N.pinchStatus){n=ot(t,U)}if(!N.triggerOnTouchEnd||N.triggerOnTouchLeave){var s=true;if(N.triggerOnTouchLeave){var o=Gt(this);s=Yt(i.end,o)}if(!N.triggerOnTouchEnd&&s){U=st(b)}else if(N.triggerOnTouchLeave&&!s){U=st(w)}if(U==E||U==w){ot(t,U)}}}else{U=E;ot(t,U)}if(n===false){U=E;ot(t,U)}}function tt(e){var t=e.originalEvent;if(S){if(t.touches.length>0){Ot();return true}}if(_t()){z=K}e.preventDefault();V=Qt();P=zt();if(N.triggerOnTouchEnd||N.triggerOnTouchEnd==false&&U===b){U=w;ot(t,U)}else if(!N.triggerOnTouchEnd&&wt()){U=w;ut(t,U,c)}else if(U===b){U=E;ot(t,U)}Pt(false)}function nt(){z=0;V=0;X=0;H=0;B=0;j=1;Mt();Pt(false)}function rt(e){var t=e.originalEvent;if(N.triggerOnTouchLeave){U=st(w);ot(t,U)}}function it(){R.unbind(k,Z);R.unbind(M,nt);R.unbind(L,et);R.unbind(A,tt);if(O){R.unbind(O,rt)}Pt(false)}function st(e){var t=e;var n=lt();var r=at();if(!n){t=E}else if(r&&e==b&&(!N.triggerOnTouchEnd||N.triggerOnTouchLeave)){t=w}else if(!r&&e==w&&N.triggerOnTouchLeave){t=E}return t}function ot(e,t){var n=undefined;if(gt()){n=ut(e,t,f)}else if(dt()&&n!==false){n=ut(e,t,l)}if(Lt()&&n!==false){n=ut(e,t,h)}else if(At()&&n!==false){n=ut(e,t,p)}else if(kt()&&n!==false){n=ut(e,t,c)}if(t===E){nt(e)}if(t===w){if(S){if(e.touches.length==0){nt(e)}}else{nt(e)}}return n}function ut(u,a,d){var v=undefined;if(d==f){R.trigger("swipeStatus",[a,D||null,_||0,P||0,z]);if(N.swipeStatus){v=N.swipeStatus.call(R,u,a,D||null,_||0,P||0,z);if(v===false)return false}if(a==w&&vt()){R.trigger("swipe",[D,_,P,z]);if(N.swipe){v=N.swipe.call(R,u,D,_,P,z);if(v===false)return false}switch(D){case t:R.trigger("swipeLeft",[D,_,P,z]);if(N.swipeLeft){v=N.swipeLeft.call(R,u,D,_,P,z)}break;case n:R.trigger("swipeRight",[D,_,P,z]);if(N.swipeRight){v=N.swipeRight.call(R,u,D,_,P,z)}break;case r:R.trigger("swipeUp",[D,_,P,z]);if(N.swipeUp){v=N.swipeUp.call(R,u,D,_,P,z)}break;case i:R.trigger("swipeDown",[D,_,P,z]);if(N.swipeDown){v=N.swipeDown.call(R,u,D,_,P,z)}break}}}if(d==l){R.trigger("pinchStatus",[a,I||null,F||0,P||0,z,j]);if(N.pinchStatus){v=N.pinchStatus.call(R,u,a,I||null,F||0,P||0,z,j);if(v===false)return false}if(a==w&&ht()){switch(I){case s:R.trigger("pinchIn",[I||null,F||0,P||0,z,j]);if(N.pinchIn){v=N.pinchIn.call(R,u,I||null,F||0,P||0,z,j)}break;case o:R.trigger("pinchOut",[I||null,F||0,P||0,z,j]);if(N.pinchOut){v=N.pinchOut.call(R,u,I||null,F||0,P||0,z,j)}break}}}if(d==c){if(a===E||a===w){clearTimeout(G);if(Et()&&!Tt()){Q=Qt();G=setTimeout(e.proxy(function(){Q=null;R.trigger("tap",[u.target]);if(N.tap){v=N.tap.call(R,u,u.target)}},this),N.doubleTapThreshold)}else{Q=null;R.trigger("tap",[u.target]);if(N.tap){v=N.tap.call(R,u,u.target)}}}}else if(d==h){if(a===E||a===w){clearTimeout(G);Q=null;R.trigger("doubletap",[u.target]);if(N.doubleTap){v=N.doubleTap.call(R,u,u.target)}}}else if(d==p){if(a===E||a===w){clearTimeout(G);Q=null;R.trigger("longtap",[u.target]);if(N.longTap){v=N.longTap.call(R,u,u.target)}}}return v}function at(){var e=true;if(N.threshold!==null){e=_>=N.threshold}if(e&&N.cancelThreshold!==null){e=qt(D)-_<N.cancelThreshold}return e}function ft(){if(N.pinchThreshold!==null){return F>=N.pinchThreshold}return true}function lt(){var e;if(N.maxTimeThreshold){if(P>=N.maxTimeThreshold){e=false}else{e=true}}else{e=true}return e}function ct(e,s){if(N.allowPageScroll===u||pt()){e.preventDefault()}else{var o=N.allowPageScroll===a;switch(s){case t:if(N.swipeLeft&&o||!o&&N.allowPageScroll!=d){e.preventDefault()}break;case n:if(N.swipeRight&&o||!o&&N.allowPageScroll!=d){e.preventDefault()}break;case r:if(N.swipeUp&&o||!o&&N.allowPageScroll!=v){e.preventDefault()}break;case i:if(N.swipeDown&&o||!o&&N.allowPageScroll!=v){e.preventDefault()}break}}}function ht(){var e=yt();var t=bt();var n=ft();return e&&t&&n}function pt(){return!!(N.pinchStatus||N.pinchIn||N.pinchOut)}function dt(){return!!(ht()&&pt())}function vt(){var e=lt();var t=at();var n=yt();var r=bt();var i=r&&n&&t&&e;return i}function mt(){return!!(N.swipe||N.swipeStatus||N.swipeLeft||N.swipeRight||N.swipeUp||N.swipeDown)}function gt(){return!!(vt()&&mt())}function yt(){return z===N.fingers||N.fingers===m||!S}function bt(){return W[0].end.x!==0}function wt(){return!!N.tap}function Et(){return!!N.doubleTap}function St(){return!!N.longTap}function xt(){if(Q==null){return false}var e=Qt();return Et()&&e-Q<=N.doubleTapThreshold}function Tt(){return xt()}function Nt(){return(z===1||!S)&&(isNaN(_)||_===0)}function Ct(){return P>N.longTapThreshold&&_<g}function kt(){return!!(Nt()&&wt())}function Lt(){return!!(xt()&&Et())}function At(){return!!(Ct()&&St())}function Ot(){J=Qt();K=event.touches.length+1}function Mt(){J=0;K=0}function _t(){var e=false;if(J){var t=Qt()-J;if(t<=N.fingerReleaseThreshold){e=true}}return e}function Dt(){return!!(R.data(x+"_intouch")===true)}function Pt(e){if(e===true){R.bind(L,et);R.bind(A,tt);if(O){R.bind(O,rt)}}else{R.unbind(L,et,false);R.unbind(A,tt,false);if(O){R.unbind(O,rt,false)}}R.data(x+"_intouch",e===true)}function Ht(e,t){var n=t.identifier!==undefined?t.identifier:0;W[e].identifier=n;W[e].start.x=W[e].end.x=t.pageX||t.clientX;W[e].start.y=W[e].end.y=t.pageY||t.clientY;return W[e]}function Bt(e){var t=e.identifier!==undefined?e.identifier:0;var n=jt(t);n.end.x=e.pageX||e.clientX;n.end.y=e.pageY||e.clientY;return n}function jt(e){for(var t=0;t<W.length;t++){if(W[t].identifier==e){return W[t]}}}function Ft(){var e=[];for(var t=0;t<=5;t++){e.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0})}return e}function It(e,t){t=Math.max(t,qt(e));q[e].distance=t}function qt(e){return q[e].distance}function Rt(){var e={};e[t]=Ut(t);e[n]=Ut(n);e[r]=Ut(r);e[i]=Ut(i);return e}function Ut(e){return{direction:e,distance:0}}function zt(){return V-X}function Wt(e,t){var n=Math.abs(e.x-t.x);var r=Math.abs(e.y-t.y);return Math.round(Math.sqrt(n*n+r*r))}function Xt(e,t){var n=t/e*1;return n.toFixed(2)}function Vt(){if(j<1){return o}else{return s}}function $t(e,t){return Math.round(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))}function Jt(e,t){var n=e.x-t.x;var r=t.y-e.y;var i=Math.atan2(r,n);var s=Math.round(i*180/Math.PI);if(s<0){s=360-Math.abs(s)}return s}function Kt(e,s){var o=Jt(e,s);if(o<=45&&o>=0){return t}else if(o<=360&&o>=315){return t}else if(o>=135&&o<=225){return n}else if(o>45&&o<135){return i}else{return r}}function Qt(){var e=new Date;return e.getTime()}function Gt(t){t=e(t);var n=t.offset();var r={left:n.left,right:n.left+t.outerWidth(),top:n.top,bottom:n.top+t.outerHeight()};return r}function Yt(e,t){return e.x>t.left&&e.x<t.right&&e.y>t.top&&e.y<t.bottom}var C=S||!N.fallbackToMouseEvents,k=C?"touchstart":"mousedown",L=C?"touchmove":"mousemove",A=C?"touchend":"mouseup",O=C?null:"mouseleave",M="touchcancel";var _=0,D=null,P=0,H=0,B=0,j=1,F=0,I=0,q=null;var R=e(T);var U="start";var z=0;var W=null;var X=0,V=0,J=0,K=0,Q=0;var G=null;try{R.bind(k,Z);R.bind(M,nt)}catch(Y){e.error("events not supported "+k+","+M+" on jQuery.swipe")}this.enable=function(){R.bind(k,Z);R.bind(M,nt);return R};this.disable=function(){it();return R};this.destroy=function(){it();R.data(x,null);return R};this.option=function(t,n){if(N[t]!==undefined){if(n===undefined){return N[t]}else{N[t]=n}}else{e.error("Option "+t+" does not exist on jQuery.swipe.options")}};}var t="left",n="right",r="up",i="down",s="in",o="out",u="none",a="auto",f="swipe",l="pinch",c="tap",h="doubletap",p="longtap",d="horizontal",v="vertical",m="all",g=10,y="start",b="move",w="end",E="cancel",S="ontouchstart"in window,x="TouchSwipe";var T={fingers:1,threshold:75,cancelThreshold:25,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:true,triggerOnTouchLeave:false,allowPageScroll:"auto",fallbackToMouseEvents:true,excludedElements:".noSwipe"};e.fn.swipe=function(t){var n=e(this),r=n.data(x);if(r&&typeof t==="string"){if(r[t]){return r[t].apply(this,Array.prototype.slice.call(arguments,1))}else{e.error("Method "+t+" does not exist on jQuery.swipe")}}else if(!r&&(typeof t==="object"||!t)){return N.apply(this,arguments)}return n};e.fn.swipe.defaults=T;e.fn.swipe.phases={PHASE_START:y,PHASE_MOVE:b,PHASE_END:w,PHASE_CANCEL:E};e.fn.swipe.directions={LEFT:t,RIGHT:n,UP:r,DOWN:i,IN:s,OUT:o};e.fn.swipe.pageScroll={NONE:u,HORIZONTAL:d,VERTICAL:v,AUTO:a};e.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:m}})(jQuery)